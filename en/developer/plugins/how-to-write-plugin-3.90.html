<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>How to write a plugin for nopCommerce </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="How to write a plugin for nopCommerce ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <link rel="preload" href="../../../fonts/fonts.css" )"="" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <meta property="docfx:navrel" content="/">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    <meta property="docfx:rel" content="../../../">
    
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-7490022-8"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-7490022-8');
    </script>
    <script>
      /*! loadCSS. [c]2017 Filament Group, Inc. MIT License
      - testing support for link[rel=preload]
      - enabling async CSS loading in browsers that do not support rel=preload
      - applying rel preload css once loaded, whether supported or not.
      */
      !function(n){"use strict";n.loadCSS||(n.loadCSS=function(){});var o=loadCSS.relpreload={};if(o.support=function(){var e;try{e=n.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),o.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},o.poly=function(){if(!o.support())for(var t=n.document.getElementsByTagName("link"),e=0;e<t.length;e++){var a=t[e];"preload"!==a.rel||"style"!==a.getAttribute("as")||a.getAttribute("data-loadcss")||(a.setAttribute("data-loadcss",!0),o.bindMediaToggle(a))}},!o.support()){o.poly();var t=n.setInterval(o.poly,500);n.addEventListener?n.addEventListener("load",function(){o.poly(),n.clearInterval(t)}):n.attachEvent&&n.attachEvent("onload",function(){o.poly(),n.clearInterval(t)})}"undefined"!=typeof exports?exports.loadCSS=loadCSS:n.loadCSS=loadCSS}("undefined"!=typeof global?global:this);
    </script>
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="170">
    <div id="wrapper">
      <header>
        <div class="container">
          <div id="header" class="header navbar-header">
            <div class="header-logo">
              <a href="https://preprod.nitrosmart.app/">
                <img id="logo" class="svg" src="../../../logo.png" alt="">
              </a>
            </div>  </div>
          <div class="navbar-collapse collapse in">
            <form class="navbar-form navbar-right" role="search" id="search">
              <div class="form-group">
                <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
              </div>
        
              <div class="form-group lang-container">
                    
                    <select id="lang-switcher" class="select-css">
                        <option value="/en/index.html" selected="">
                          English
                        
                    </select>        </div>
            </form>
          </div>
        </div>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="en/developer/plugins/how-to-write-plugin-3.90">
<h1 id="how-to-write-a-plugin-for-nopcommerce-390-and-previous-versions">How to write a plugin for nopCommerce 3.90 (and previous versions)</h1>

<blockquote>
<p>In computing, a plug-in (or plugin) is a set of software components that add specific abilities to a larger software application (Wikipedia).</p>
</blockquote>
<p>Plugins are used to extend the functionality of nopCommerce. nopCommerce has several types of plugins. For example, payment methods (such as PayPal), tax providers, shipping method computation methods (such as UPS, USP, FedEx), widgets (such as 'live chat' block), and many others. nopCommerce is already distributed with many different plugins. You can also search various plugins on the <a href="https://www.nopcommerce.com/marketplace">nopCommerce official site</a> to see if someone has already created a plugin that suits your needs. If not, this article will guide you through the process of creating your plugin.</p>
<h2 id="the-plugin-structure-required-files-and-locations">The plugin structure, required files, and locations</h2>
<ol>
<li><p>First thing you need to do is to create a new &quot;Class Library&quot; project in the solution. It's a good practice to place all plugins into the <code>\Plugins</code> directory in the root of your solution (do not mix up with \Plugins subdirectory located in <code>\Nop.Web</code> directory which is used for already deployed plugins). It's a good practice to place all plugins into the &quot;Plugins&quot; solution folder (you can find more information about solution folders <a href="http://msdn.microsoft.com/library/sx2027y2.aspx">here</a>).</p>
<p>A recommended name for a plugin project is &quot;Nop.Plugin.{Group}.{Name}&quot;. {Group} is your plugin group (for example, &quot;Payment&quot; or &quot;Shipping&quot;). {Name} is your plugin name (for example, &quot;PayPalStandard&quot;). For example, the PayPal Standard payment plugin has the following name: Nop.Plugin.Payments.PayPalStandard. But please note that it's not a requirement. And you can choose any name for a plugin. For example, &quot;MyGreatPlugin&quot;.</p>
<p><img src="_static/how-to-write-plugin-3.90/write_plugin_3.90_4.jpg" alt="p1"></p>
</li>
<li><p>Once the plugin project is created update the project build output path. Set it to <code>..\..\Presentation\Nop.Web\Plugins\{Group}.{Name}</code>. For example, Authorize.NET payment plugin has the following output path: <code>..\..\Presentation\Nop.Web\Plugins\Payments.AuthorizeNet</code>. After it's done, appropriate plugin DLLs will be automatically copied to the <code>\Presentation\Nop.Web\Plugins</code> directory which is searched by the nopCommerce core for valid plugins. But please note that it's also not a requirement. And you can choose any output directory name for a plugin.</p>
<p><img src="_static/how-to-write-plugin-3.90/write_plugin_3.90_1.jpg" alt="p1"></p>
<ul>
<li>On the Project menu, click Properties.</li>
<li>Click the Build tab.</li>
<li>Click the Browse button next to the Output path box and select a new build output directory.</li>
</ul>
<p>You should do the steps described above to all existing configurations (&quot;Debug&quot; and &quot;Release&quot;).</p>
</li>
<li><p>The next step is creating a <code>Description.txt</code> file required for each plugin. This file contains meta-information describing your plugin. Just copy this file from any other existing plugin and modify it for your needs. For example, the PayPal Standard payment plugin has the following <code>Description.txt</code> file:</p>
<pre><code class="lang-txt">Group: Payment methods
FriendlyName: PayPal Standard
SystemName: Payments.PayPalStandard
Version: 1.28
SupportedVersions: 3.90
Author: nopCommerce team
DisplayOrder: 1
FileName: Nop.Plugin.Payments.PayPalStandard.dll
Description: This plugin allows paying with PayPal Standard
</code></pre>
<p>All fields are self-descriptive, but here are some notes. <strong>SystemName</strong> field should be unique. <strong>Version</strong> field is a version number of your plugin; you can set it to any value you like. <strong>SupportedVersions</strong> field can contain a list of supported nopCommerce versions separated by commas (ensure that the current version of nopCommerce is included in this list, otherwise, it will not be loaded). <strong>FileName</strong> field has the following format <em>Nop.Plugin.{Group}.{Name}.dll</em> (it is your plugin assembly filename). Ensure that the &quot;Copy to Output Directory&quot; property of this file is set to &quot;Copy if newer&quot;.</p>
<p><img src="_static/how-to-write-plugin-3.90/write_plugin_3.90_2.jpg" alt="p2"></p>
</li>
<li><p>You should also created a web.config file and ensure that it's copied to the output. Just copy it from any existing plugin.</p>
<div class="IMPORTANT">
<h5>Important</h5>
<p>Going forward make sure &quot;Copy local&quot; properties of all third-party assembly references (including core libraries such as Nop.Services.dll or Nop.Web.Framework.dll) are set to &quot;False&quot; (do not copy)</p>
</div>
</li>
<li><p>The last required step is to create a class that implements the IPlugin interface (Nop.Core.Plugins namespace). nopCommerce has BasePlugin class which already implements some IPlugin methods and allows you to avoid source code duplication. nopCommerce also provides you with some specific interfaces derived from IPlugin. For example, we have the &quot;IPaymentMethod&quot; interface which is used for creating new payment method plugins. It contains some methods which are specific only for payment methods such as ProcessPayment() or GetAdditionalHandlingFee(). Currently, nopCommerce has the following specific plugin interfaces:</p>
<ul>
<li><strong>IPaymentMethod</strong>. These plugins are used for payment processing.</li>
<li><strong>IShippingRateComputationMethod</strong>. These plugins are used for retrieving accepted delivery methods and appropriate shipping rates. For example, UPS, UPS, FedEx, etc.</li>
<li><strong>IPickupPointProvider</strong>. These plugins are used for providing pickup points.</li>
<li><strong>ITaxProvider</strong>. Tax providers are used for getting tax rates.</li>
<li><strong>IExchangeRateProvider</strong>. Used for getting currency exchange rate.</li>
<li><strong>IDiscountRequirementRule</strong>. Allows you to create new discount rules such as &quot;Billing country of a customer should be…&quot;</li>
<li><strong>IExternalAuthenticationMethod</strong>. Used for creating external authentication methods such as Facebook, Twitter, OpenID, etc.</li>
<li><strong>IWidgetPlugin</strong>. It allows you to create widgets. Widgets are rendered on some parts of your site. For example, it can be a &quot;Live chat&quot; block on your site's left column.</li>
<li><strong>IMiscPlugin</strong>. If your plugin doesn't fit any of the interfaces above.</li>
</ul>
</li>
</ol>
<div class="IMPORTANT">
<h5>Important</h5>
<p>After each project build, clean the solution before making changes. Some resources will be cached and can lead to developer insanity.</p>
</div>
<h2 id="handling-requests-controllers-models-and-views">Handling requests. Controllers, models, and views</h2>
<p>Now you can see the plugin by going to <strong>Admin area → Configuration → Plugins</strong>. But as you guessed our plugin does nothing. It does not even have a user interface for its configuration. Let's create a page to configure the plugin.</p>
<p>What we need to do now is create a controller, a model, and a view.</p>
<ul>
<li>MVC controllers are responsible for responding to requests made against an ASP.NET MVC website. Each browser request is mapped to a particular controller.</li>
<li>A view contains the HTML markup and content that is sent to the browser. A view is the equivalent of a page when working with an ASP.NET MVC application.</li>
<li>An MVC model contains all of your application logic that is not contained in a view or a controller.</li>
</ul>
<p>You can find more information about the MVC pattern <a href="http://www.asp.net/mvc/tutorials/older-versions/overview/understanding-models-views-and-controllers-cs">here</a>.</p>
<p>So let's start:</p>
<ul>
<li><p><strong>Create the model</strong>. Add a Models folder in the new plugin, and then add a new model class that fits your need.</p>
</li>
<li><p><strong>Create the view</strong>. Add a Views folder in the new plugin, then add a {Name} folder (where {Name} is your plugin name), and finally add a cshtml file named <code>Configure.cshtml</code>. Important note: for versions 2.00-3.30 the view should be marked as an embedded resource. And starting version 3.40 views, ensure that the &quot;Build Action&quot; property of the view file is set to &quot;Content&quot;, and the &quot;Copy to Output Directory&quot; property is set to &quot;Copy if newer&quot;.</p>
</li>
<li><p><strong>Create the controller</strong>. Add a Controllers folder in the new plugin, and then add a new controller class. A good practice is to name plugin controllers <code>{Group}{Name}Controller.cs</code>. For example, PaymentAuthorizeNetController. Of course, it's not a requirement to name controllers this way (but just a recommendation). Then create an appropriate action method for the configuration page (in the admin area). Let's name it &quot;Configure&quot;. Prepare a model class and pass it to the following view. For nopCommerce versions 2.00-3.30 you should pass embedded view path - &quot;Nop.Plugin.{Group}.{Name}.Views. {Group}{Name}.Configure&quot;. And starting nopCommerce version 3.40 you should pass physical view path - <code>~/Plugins/{PluginOutputDirectory}/Views/{ControllerName}/Configure.cshtml</code>. For example, open the Authorize.NET payment plugin and look at its implementation of PaymentAuthorizeNetController.</p>
<div class="TIP">
<h5>Tip</h5>
<ul>
<li><p>The easiest way to complete the steps described above is by opening any other plugin and copying these files into your plugin project. Then just rename appropriate classes and directories.</p>
</li>
<li><p>If you want to limit access to a certain action method of the controller to administrators (store owners), then just mark it with the [AdminAuthorize] attribute.</p>
</li>
</ul>
</div>
<p>For example, the project structure of the Authorize.NET plugin looks like the image below</p>
<p><img src="_static/how-to-write-plugin-3.90/write_plugin_3.90_3.jpg" alt="p3"></p>
</li>
</ul>
<h2 id="routes">Routes</h2>
<p>Now we need to register appropriate plugin routes. ASP.NET routing is responsible for mapping incoming browser requests to particular MVC controller actions. You can find more information about routing <a href="http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/asp-net-mvc-routing-overview-cs">here</a>. So follow the next steps:</p>
<ul>
<li><p>Some of the specific plugin interfaces (described above) and the &quot;IMiscPlugin&quot; interface have the following method: &quot;GetConfigurationRoute&quot;. It should return a route to a controller action that is used for plugin configuration. Implement the &quot;GetConfigurationRoute&quot; method of your plugin interface. This method informs nopCommerce about what route is used for plugin configuration. If your plugin doesn't have a configuration page, then &quot;GetConfigurationRoute&quot; should return null. For example, see the code below:</p>
<pre><code class="lang-csharp">public void GetConfigurationRoute(out string actionName,
            out string controllerName,
            out RouteValueDictionary routeValues)
{
    actionName = &quot;Configure&quot;;
    controllerName = &quot;PaymentAuthorizeNet&quot;;
    routeValues = new RouteValueDictionary()
    {
        { &quot;Namespaces&quot;, &quot;Nop.Plugin.Payments.AuthorizeNet.Controllers&quot; },
        { &quot;area&quot;, null }
    };
}
</code></pre>
</li>
<li><p>(optional) If you need to add some custom route, then create the <code>RouteProvider.cs</code> file. It informs the nopCommerce system about plugin routes. For example, the following RouteProvider class adds a new route which can be accessed by opening your web browser and navigating to <code>http://www.yourStore.com/Plugins/PaymentPayPalStandard/PDTHandler</code> URL (used by PayPal plugin):</p>
<pre><code class="lang-csharp">public partial class RouteProvider : IRouteProvider
{
    public void RegisterRoutes(RouteCollection routes)
    {
         routes.MapRoute(&quot;Plugin.Payments.PayPalStandard.PDTHandler&quot;,
             &quot;Plugins/PaymentPayPalStandard/PDTHandler&quot;,
             new { controller = &quot;PaymentPayPalStandard&quot;, action = &quot;PDTHandler&quot; },
             new[] { &quot;Nop.Plugin.Payments.PayPalStandard.Controllers&quot;  }
        );
    }

    public int Priority
    {
        get
        {
            return 0;
        }
    }
}
</code></pre>
<p>Once you have installed your plugin and added the configuration method you will find a link to configure your plugin under Admin → Configuration → Plugins.</p>
</li>
</ul>
<h2 id="handling-install-and-uninstall-methods">Handling &quot;Install&quot; and &quot;Uninstall&quot; methods</h2>
<p>This step is optional. Some plugins can require additional logic during plugin installation. For example, a plugin can insert new locale resources. So open your IPlugin implementation (in most cases it'll be derived from BasePlugin class) and override the following methods:</p>
<ul>
<li>Install. This method will be invoked during plugin installation. You can initialize any settings here, insert new locale resources, or create some new database tables (if required).</li>
<li>Uninstall. This method will be invoked during plugin uninstallation.</li>
</ul>
<div class="IMPORTANT">
<h5>Important</h5>
<p>If you override one of these methods, do not hide its base implementation.</p>
</div>
<p>For example, the project structure of the Authorize.NET plugin looks like the image below</p>
<pre><code class="lang-csharp">public override void Install()
{
    var settings = new AuthorizeNetPaymentSettings()
    {
        UseSandbox = true,
        TransactMode = TransactMode.Authorize,
        TransactionKey = &quot;123&quot;,
        LoginId = &quot;456&quot;
    };
    _settingService.SaveSetting(settings);
    base.Install();
}
</code></pre>
<div class="TIP">
<h5>Tip</h5>
<p>The list of installed plugins is located in <code>\App_Data\InstalledPlugins.txt</code>. The list is created during installation.</p>
</div>
<h2 id="upgrading-nopcommerce-may-break-plugins">Upgrading nopCommerce may break plugins</h2>
<p>Some plugins may become outdated and no longer work with the newer version of nopCommerce. If you have issues after upgrading to the newer version, delete the plugin and visit the official nopCommerce website to see if a newer version is available. Many plugin authors will upgrade their plugins to accommodate the newer version, however, some will not and their plugin will become obsolete with the improvements in nopCommerce. But in most cases, you can simply open an appropriate <code>plugin.json</code> file and update the <strong>SupportedVersions</strong> field.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Hopefully, this will get you started with nopCommerce and prepare you to build more elaborate plugins.</p>

                  <div class="course-banner">
                      <a target="_blank" href="https://www.nopcommerce.com/training?utm_source=docs_nopcommerce&utm_medium=documentation&utm_campaign=course&utm_content=Developers_Guide">
                          <div class="course-banner-left"></div>
                          <div class="course-banner-center">
                              <div class="course-banner-title"><span>nopCommerce training course</span></div>
                              <div class="course-banner-description"><span>Start developing your skills and become a Certified Developer</span></div>
                          </div>
                          <div class="course-banner-right"></div>
                      </a> 
                  </div>            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/nopSolutions/NitroSmartDocs/blob/master/en/developer/plugins/how-to-write-plugin-3.90.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
